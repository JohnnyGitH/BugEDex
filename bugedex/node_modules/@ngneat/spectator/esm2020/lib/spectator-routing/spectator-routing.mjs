import { Spectator } from '../spectator/spectator';
import { isRouterStub } from './router-stub';
/**
 * @publicApi
 */
export class SpectatorRouting extends Spectator {
    constructor(fixture, debugElement, instance, router, activatedRouteStub) {
        super(fixture, debugElement, instance, debugElement.nativeElement);
        this.router = router;
        this.activatedRouteStub = activatedRouteStub;
    }
    /**
     * Simulates a route navigation by updating the Params, QueryParams and Data observable streams.
     */
    triggerNavigation(options) {
        if (!this.checkStubPresent()) {
            return;
        }
        if (options && options.params) {
            this.activatedRouteStub.setParams(options.params);
        }
        if (options && options.queryParams) {
            this.activatedRouteStub.setQueryParams(options.queryParams);
        }
        if (options && options.data) {
            this.activatedRouteStub.setAllData(options.data);
        }
        if (options && options.fragment) {
            this.activatedRouteStub.setFragment(options.fragment);
        }
        this.triggerNavigationAndUpdate();
    }
    /**
     * Updates the route params and triggers a route navigation.
     */
    setRouteParam(name, value) {
        if (this.checkStubPresent()) {
            this.activatedRouteStub.setParam(name, value);
            this.triggerNavigationAndUpdate();
        }
    }
    /**
     * Updates the route query params and triggers a route navigation.
     */
    setRouteQueryParam(name, value) {
        if (this.checkStubPresent()) {
            this.activatedRouteStub.setQueryParam(name, value);
            this.triggerNavigationAndUpdate();
        }
    }
    /**
     * Updates the route data and triggers a route navigation.
     * The `value` is typed as `any` since the `Route#data` is a record with `any` values.
     * There's no sense to make it generic until `Route#data` starts supporting generic types.
     */
    setRouteData(name, value) {
        if (this.checkStubPresent()) {
            this.activatedRouteStub.setData(name, value);
            this.triggerNavigationAndUpdate();
        }
    }
    /**
     * Updates the route fragment and triggers a route navigation.
     */
    setRouteFragment(fragment) {
        if (this.checkStubPresent()) {
            this.activatedRouteStub.setFragment(fragment);
            this.triggerNavigationAndUpdate();
        }
    }
    /**
     * Updates the route url and triggers a route navigation.
     */
    setRouteUrl(url) {
        if (this.checkStubPresent()) {
            this.activatedRouteStub.setUrl(url);
            this.triggerNavigationAndUpdate();
        }
    }
    /**
     * Emits a router event
     */
    emitRouterEvent(event) {
        if (!isRouterStub(this.router)) {
            // eslint-disable-next-line no-console
            console.warn('No stub for Router present. Set Spectator option "stubsEnabled" to true if you want to use this ' +
                'helper, or use Router navigation to trigger events.');
            return;
        }
        this.router.emitRouterEvent(event);
    }
    triggerNavigationAndUpdate() {
        this.activatedRouteStub.triggerNavigation();
        this.detectChanges();
    }
    checkStubPresent() {
        if (!this.activatedRouteStub) {
            // eslint-disable-next-line no-console
            console.warn('No stub for ActivatedRoute present. Set Spectator option "stubsEnabled" to true if you want to use this ' +
                'helper, or use Router to trigger navigation.');
            return false;
        }
        return true;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3BlY3RhdG9yLXJvdXRpbmcuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9zcGVjdGF0b3Ivc3JjL2xpYi9zcGVjdGF0b3Itcm91dGluZy9zcGVjdGF0b3Itcm91dGluZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFJQSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFJbkQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUU3Qzs7R0FFRztBQUNILE1BQU0sT0FBTyxnQkFBb0IsU0FBUSxTQUFZO0lBQ25ELFlBQ0UsT0FBOEIsRUFDOUIsWUFBMEIsRUFDMUIsUUFBVyxFQUNLLE1BQWMsRUFDZCxrQkFBdUM7UUFFdkQsS0FBSyxDQUFDLE9BQU8sRUFBRSxZQUFZLEVBQUUsUUFBUSxFQUFFLFlBQVksQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUhuRCxXQUFNLEdBQU4sTUFBTSxDQUFRO1FBQ2QsdUJBQWtCLEdBQWxCLGtCQUFrQixDQUFxQjtJQUd6RCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxpQkFBaUIsQ0FBQyxPQUFzQjtRQUM3QyxJQUFJLENBQUMsSUFBSSxDQUFDLGdCQUFnQixFQUFFLEVBQUU7WUFDNUIsT0FBTztTQUNSO1FBRUQsSUFBSSxPQUFPLElBQUksT0FBTyxDQUFDLE1BQU0sRUFBRTtZQUM3QixJQUFJLENBQUMsa0JBQWtCLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztTQUNuRDtRQUVELElBQUksT0FBTyxJQUFJLE9BQU8sQ0FBQyxXQUFXLEVBQUU7WUFDbEMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7U0FDN0Q7UUFFRCxJQUFJLE9BQU8sSUFBSSxPQUFPLENBQUMsSUFBSSxFQUFFO1lBQzNCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ2xEO1FBRUQsSUFBSSxPQUFPLElBQUksT0FBTyxDQUFDLFFBQVEsRUFBRTtZQUMvQixJQUFJLENBQUMsa0JBQWtCLENBQUMsV0FBVyxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztTQUN2RDtRQUVELElBQUksQ0FBQywwQkFBMEIsRUFBRSxDQUFDO0lBQ3BDLENBQUM7SUFFRDs7T0FFRztJQUNJLGFBQWEsQ0FBQyxJQUFZLEVBQUUsS0FBYTtRQUM5QyxJQUFJLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxFQUFFO1lBQzNCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQzlDLElBQUksQ0FBQywwQkFBMEIsRUFBRSxDQUFDO1NBQ25DO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0ksa0JBQWtCLENBQUMsSUFBWSxFQUFFLEtBQWE7UUFDbkQsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsRUFBRTtZQUMzQixJQUFJLENBQUMsa0JBQWtCLENBQUMsYUFBYSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztZQUNuRCxJQUFJLENBQUMsMEJBQTBCLEVBQUUsQ0FBQztTQUNuQztJQUNILENBQUM7SUFFRDs7OztPQUlHO0lBQ0ksWUFBWSxDQUFDLElBQVksRUFBRSxLQUFVO1FBQzFDLElBQUksSUFBSSxDQUFDLGdCQUFnQixFQUFFLEVBQUU7WUFDM0IsSUFBSSxDQUFDLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDN0MsSUFBSSxDQUFDLDBCQUEwQixFQUFFLENBQUM7U0FDbkM7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxnQkFBZ0IsQ0FBQyxRQUF1QjtRQUM3QyxJQUFJLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxFQUFFO1lBQzNCLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDOUMsSUFBSSxDQUFDLDBCQUEwQixFQUFFLENBQUM7U0FDbkM7SUFDSCxDQUFDO0lBRUQ7O09BRUc7SUFDSSxXQUFXLENBQUMsR0FBaUI7UUFDbEMsSUFBSSxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsRUFBRTtZQUMzQixJQUFJLENBQUMsa0JBQWtCLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ3BDLElBQUksQ0FBQywwQkFBMEIsRUFBRSxDQUFDO1NBQ25DO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0ksZUFBZSxDQUFDLEtBQVk7UUFDakMsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDOUIsc0NBQXNDO1lBQ3RDLE9BQU8sQ0FBQyxJQUFJLENBQ1Ysa0dBQWtHO2dCQUNoRyxxREFBcUQsQ0FDeEQsQ0FBQztZQUVGLE9BQU87U0FDUjtRQUVELElBQUksQ0FBQyxNQUFNLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3JDLENBQUM7SUFFTywwQkFBMEI7UUFDaEMsSUFBSSxDQUFDLGtCQUFtQixDQUFDLGlCQUFpQixFQUFFLENBQUM7UUFDN0MsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3ZCLENBQUM7SUFFTyxnQkFBZ0I7UUFDdEIsSUFBSSxDQUFDLElBQUksQ0FBQyxrQkFBa0IsRUFBRTtZQUM1QixzQ0FBc0M7WUFDdEMsT0FBTyxDQUFDLElBQUksQ0FDViwwR0FBMEc7Z0JBQ3hHLDhDQUE4QyxDQUNqRCxDQUFDO1lBRUYsT0FBTyxLQUFLLENBQUM7U0FDZDtRQUVELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGVidWdFbGVtZW50IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBDb21wb25lbnRGaXh0dXJlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZS90ZXN0aW5nJztcbmltcG9ydCB7IEV2ZW50LCBSb3V0ZXIsIFVybFNlZ21lbnQgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuXG5pbXBvcnQgeyBTcGVjdGF0b3IgfSBmcm9tICcuLi9zcGVjdGF0b3Ivc3BlY3RhdG9yJztcblxuaW1wb3J0IHsgQWN0aXZhdGVkUm91dGVTdHViIH0gZnJvbSAnLi9hY3RpdmF0ZWQtcm91dGUtc3R1Yic7XG5pbXBvcnQgeyBSb3V0ZU9wdGlvbnMgfSBmcm9tICcuL3JvdXRlLW9wdGlvbnMnO1xuaW1wb3J0IHsgaXNSb3V0ZXJTdHViIH0gZnJvbSAnLi9yb3V0ZXItc3R1Yic7XG5cbi8qKlxuICogQHB1YmxpY0FwaVxuICovXG5leHBvcnQgY2xhc3MgU3BlY3RhdG9yUm91dGluZzxDPiBleHRlbmRzIFNwZWN0YXRvcjxDPiB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGZpeHR1cmU6IENvbXBvbmVudEZpeHR1cmU8YW55PixcbiAgICBkZWJ1Z0VsZW1lbnQ6IERlYnVnRWxlbWVudCxcbiAgICBpbnN0YW5jZTogQyxcbiAgICBwdWJsaWMgcmVhZG9ubHkgcm91dGVyOiBSb3V0ZXIsXG4gICAgcHVibGljIHJlYWRvbmx5IGFjdGl2YXRlZFJvdXRlU3R1Yj86IEFjdGl2YXRlZFJvdXRlU3R1YlxuICApIHtcbiAgICBzdXBlcihmaXh0dXJlLCBkZWJ1Z0VsZW1lbnQsIGluc3RhbmNlLCBkZWJ1Z0VsZW1lbnQubmF0aXZlRWxlbWVudCk7XG4gIH1cblxuICAvKipcbiAgICogU2ltdWxhdGVzIGEgcm91dGUgbmF2aWdhdGlvbiBieSB1cGRhdGluZyB0aGUgUGFyYW1zLCBRdWVyeVBhcmFtcyBhbmQgRGF0YSBvYnNlcnZhYmxlIHN0cmVhbXMuXG4gICAqL1xuICBwdWJsaWMgdHJpZ2dlck5hdmlnYXRpb24ob3B0aW9ucz86IFJvdXRlT3B0aW9ucyk6IHZvaWQge1xuICAgIGlmICghdGhpcy5jaGVja1N0dWJQcmVzZW50KCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLnBhcmFtcykge1xuICAgICAgdGhpcy5hY3RpdmF0ZWRSb3V0ZVN0dWIuc2V0UGFyYW1zKG9wdGlvbnMucGFyYW1zKTtcbiAgICB9XG5cbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLnF1ZXJ5UGFyYW1zKSB7XG4gICAgICB0aGlzLmFjdGl2YXRlZFJvdXRlU3R1Yi5zZXRRdWVyeVBhcmFtcyhvcHRpb25zLnF1ZXJ5UGFyYW1zKTtcbiAgICB9XG5cbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmRhdGEpIHtcbiAgICAgIHRoaXMuYWN0aXZhdGVkUm91dGVTdHViLnNldEFsbERhdGEob3B0aW9ucy5kYXRhKTtcbiAgICB9XG5cbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmZyYWdtZW50KSB7XG4gICAgICB0aGlzLmFjdGl2YXRlZFJvdXRlU3R1Yi5zZXRGcmFnbWVudChvcHRpb25zLmZyYWdtZW50KTtcbiAgICB9XG5cbiAgICB0aGlzLnRyaWdnZXJOYXZpZ2F0aW9uQW5kVXBkYXRlKCk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgcm91dGUgcGFyYW1zIGFuZCB0cmlnZ2VycyBhIHJvdXRlIG5hdmlnYXRpb24uXG4gICAqL1xuICBwdWJsaWMgc2V0Um91dGVQYXJhbShuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jaGVja1N0dWJQcmVzZW50KCkpIHtcbiAgICAgIHRoaXMuYWN0aXZhdGVkUm91dGVTdHViLnNldFBhcmFtKG5hbWUsIHZhbHVlKTtcbiAgICAgIHRoaXMudHJpZ2dlck5hdmlnYXRpb25BbmRVcGRhdGUoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyB0aGUgcm91dGUgcXVlcnkgcGFyYW1zIGFuZCB0cmlnZ2VycyBhIHJvdXRlIG5hdmlnYXRpb24uXG4gICAqL1xuICBwdWJsaWMgc2V0Um91dGVRdWVyeVBhcmFtKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNoZWNrU3R1YlByZXNlbnQoKSkge1xuICAgICAgdGhpcy5hY3RpdmF0ZWRSb3V0ZVN0dWIuc2V0UXVlcnlQYXJhbShuYW1lLCB2YWx1ZSk7XG4gICAgICB0aGlzLnRyaWdnZXJOYXZpZ2F0aW9uQW5kVXBkYXRlKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIHJvdXRlIGRhdGEgYW5kIHRyaWdnZXJzIGEgcm91dGUgbmF2aWdhdGlvbi5cbiAgICogVGhlIGB2YWx1ZWAgaXMgdHlwZWQgYXMgYGFueWAgc2luY2UgdGhlIGBSb3V0ZSNkYXRhYCBpcyBhIHJlY29yZCB3aXRoIGBhbnlgIHZhbHVlcy5cbiAgICogVGhlcmUncyBubyBzZW5zZSB0byBtYWtlIGl0IGdlbmVyaWMgdW50aWwgYFJvdXRlI2RhdGFgIHN0YXJ0cyBzdXBwb3J0aW5nIGdlbmVyaWMgdHlwZXMuXG4gICAqL1xuICBwdWJsaWMgc2V0Um91dGVEYXRhKG5hbWU6IHN0cmluZywgdmFsdWU6IGFueSk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNoZWNrU3R1YlByZXNlbnQoKSkge1xuICAgICAgdGhpcy5hY3RpdmF0ZWRSb3V0ZVN0dWIuc2V0RGF0YShuYW1lLCB2YWx1ZSk7XG4gICAgICB0aGlzLnRyaWdnZXJOYXZpZ2F0aW9uQW5kVXBkYXRlKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgdGhlIHJvdXRlIGZyYWdtZW50IGFuZCB0cmlnZ2VycyBhIHJvdXRlIG5hdmlnYXRpb24uXG4gICAqL1xuICBwdWJsaWMgc2V0Um91dGVGcmFnbWVudChmcmFnbWVudDogc3RyaW5nIHwgbnVsbCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNoZWNrU3R1YlByZXNlbnQoKSkge1xuICAgICAgdGhpcy5hY3RpdmF0ZWRSb3V0ZVN0dWIuc2V0RnJhZ21lbnQoZnJhZ21lbnQpO1xuICAgICAgdGhpcy50cmlnZ2VyTmF2aWdhdGlvbkFuZFVwZGF0ZSgpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGVzIHRoZSByb3V0ZSB1cmwgYW5kIHRyaWdnZXJzIGEgcm91dGUgbmF2aWdhdGlvbi5cbiAgICovXG4gIHB1YmxpYyBzZXRSb3V0ZVVybCh1cmw6IFVybFNlZ21lbnRbXSk6IHZvaWQge1xuICAgIGlmICh0aGlzLmNoZWNrU3R1YlByZXNlbnQoKSkge1xuICAgICAgdGhpcy5hY3RpdmF0ZWRSb3V0ZVN0dWIuc2V0VXJsKHVybCk7XG4gICAgICB0aGlzLnRyaWdnZXJOYXZpZ2F0aW9uQW5kVXBkYXRlKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEVtaXRzIGEgcm91dGVyIGV2ZW50XG4gICAqL1xuICBwdWJsaWMgZW1pdFJvdXRlckV2ZW50KGV2ZW50OiBFdmVudCk6IHZvaWQge1xuICAgIGlmICghaXNSb3V0ZXJTdHViKHRoaXMucm91dGVyKSkge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgJ05vIHN0dWIgZm9yIFJvdXRlciBwcmVzZW50LiBTZXQgU3BlY3RhdG9yIG9wdGlvbiBcInN0dWJzRW5hYmxlZFwiIHRvIHRydWUgaWYgeW91IHdhbnQgdG8gdXNlIHRoaXMgJyArXG4gICAgICAgICAgJ2hlbHBlciwgb3IgdXNlIFJvdXRlciBuYXZpZ2F0aW9uIHRvIHRyaWdnZXIgZXZlbnRzLidcbiAgICAgICk7XG5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnJvdXRlci5lbWl0Um91dGVyRXZlbnQoZXZlbnQpO1xuICB9XG5cbiAgcHJpdmF0ZSB0cmlnZ2VyTmF2aWdhdGlvbkFuZFVwZGF0ZSgpOiB2b2lkIHtcbiAgICB0aGlzLmFjdGl2YXRlZFJvdXRlU3R1YiEudHJpZ2dlck5hdmlnYXRpb24oKTtcbiAgICB0aGlzLmRldGVjdENoYW5nZXMoKTtcbiAgfVxuXG4gIHByaXZhdGUgY2hlY2tTdHViUHJlc2VudCgpOiB0aGlzIGlzIHsgcmVhZG9ubHkgYWN0aXZhdGVkUm91dGVTdHViOiBBY3RpdmF0ZWRSb3V0ZVN0dWIgfSB7XG4gICAgaWYgKCF0aGlzLmFjdGl2YXRlZFJvdXRlU3R1Yikge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgJ05vIHN0dWIgZm9yIEFjdGl2YXRlZFJvdXRlIHByZXNlbnQuIFNldCBTcGVjdGF0b3Igb3B0aW9uIFwic3R1YnNFbmFibGVkXCIgdG8gdHJ1ZSBpZiB5b3Ugd2FudCB0byB1c2UgdGhpcyAnICtcbiAgICAgICAgICAnaGVscGVyLCBvciB1c2UgUm91dGVyIHRvIHRyaWdnZXIgbmF2aWdhdGlvbi4nXG4gICAgICApO1xuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbn1cbiJdfQ==