/** Credit: https://github.com/unindented/custom-jquery-matchers/tree/master/packages/custom-jquery-matchers */
/* eslint-disable no-shadow, @typescript-eslint/no-shadow */
import $ from 'jquery';
import { hex2rgb, isHex, trim } from './internals/rgb-to-hex';
import { isHTMLOptionElementArray, isObject } from './types';
import { isRunningInJsDom, coerceArray } from './utils';
const hasProperty = (actual, expected) => {
    return expected === undefined ? actual !== undefined : actual === expected;
};
const containsProperty = (actual, expected) => {
    return expected === undefined ? true : actual.includes(expected);
};
const checkProperty = (el, prop, predicate) => {
    let pass = false;
    let failing = '';
    for (const key of Object.keys(prop)) {
        const actual = $(el).prop(key);
        const addendum = prop[key] !== undefined ? ` with value '${prop[key]}'` : '';
        pass = predicate(actual, prop[key]);
        failing = !pass ? `'${prop}'${addendum}, but had '${actual}'` : '';
    }
    const message = () => `Expected element${pass ? ' not' : ''} to have property ${failing}`;
    return { pass, message };
};
const hasCss = (el, css) => {
    let prop;
    let value;
    const $el = $(el);
    for (prop in css) {
        if (css.hasOwnProperty(prop)) {
            value = css[prop];
            if (isHex(value)) {
                value = hex2rgb(css[prop]);
            }
            if (value === 'auto' && $el.get(0).style[prop] === 'auto') {
                continue;
            }
            if (trim($el.get(0).style[prop]) !== trim(value) && trim(el.style[prop]) !== trim(value)) {
                return false;
            }
        }
    }
    return true;
};
const hasSameText = (el, expected, exact = false) => {
    if (expected && Array.isArray(expected)) {
        let actual;
        let pass = false;
        let failing;
        $(el).each((i, e) => {
            actual = exact ? $(e).text() : $.trim($(e).text());
            pass = exact ? actual === expected[i] : actual.includes(expected[i]);
            if (!pass) {
                failing = expected[i];
                return false;
            }
        });
        const message = () => `Expected element${pass ? ' not' : ''} to have ${exact ? 'exact' : ''} text '${failing}', but had '${actual}'`;
        return { pass, message };
    }
    const actual = exact ? $(el).text() : $.trim($(el).text());
    if (expected && typeof expected !== 'string') {
        const pass = expected(actual);
        const message = () => `Expected element${pass ? ' not' : ''} to have ${exact ? 'exact' : ''} text matching '${expected}',` + ` but had '${actual}'`;
        return { pass, message };
    }
    const pass = exact && !Array.isArray(expected) ? actual === expected : actual.indexOf(expected) !== -1;
    const message = () => `Expected element${pass ? ' not' : ''} to have ${exact ? 'exact' : ''} text '${expected}', but had '${actual}'`;
    return { pass, message };
};
const comparator = (func) => () => ({
    compare: func,
});
/**
 *
 * expect('.zippy__content').not.toExist();
 */
export const toExist = comparator((el) => {
    const actual = $(el).length;
    const pass = actual > 0;
    const message = () => `Expected ${el} element${pass ? ' not' : ''} to exist`;
    return { pass, message };
});
/**
 *
 * expect('.zippy__content').toHaveLength(3);
 */
export const toHaveLength = comparator((el, expected) => {
    const actual = $(el).length;
    const pass = actual === expected;
    const message = () => `Expected element${pass ? ' not' : ''} to have length ${expected}, but had ${actual}`;
    return { pass, message };
});
/**
 *
 * expect('.zippy__content').toHaveId('ID');
 */
export const toHaveId = comparator((el, expected) => {
    const actual = $(el).attr('id');
    const pass = actual === expected;
    const message = () => `Expected element${pass ? ' not' : ''} to have ID '${expected}', but had '${actual}'`;
    return { pass, message };
});
/**
 * This validates classes in strict order. If you want to validate classes in any order,
 * just set the strict config option to false.
 *
 * expect('.zippy__content').toHaveClass('class');
 * expect('.zippy__content').toHaveClass('class-a, class-b');
 * expect('.zippy__content').toHaveClass(['class-a, class-b']);
 * expect('.zippy__content').toHaveClass(['class-b, class-a']);
 * expect('.zippy__content').not.toHaveClass(['class-b, class-a'], { strict: true });
 */
export const toHaveClass = comparator((el, expected, options = { strict: true }) => {
    if (expected && Array.isArray(expected)) {
        const actual = $(el).attr('class');
        const expectedClasses = expected.join(' ');
        const pass = options.strict ? $(el).hasClass(expectedClasses) : expected.every((e) => $(el).hasClass(e));
        const message = () => `Expected element${pass ? ' not' : ''} to have value '${expectedClasses}', but had '${actual}'`;
        return { pass, message };
    }
    const actual = $(el).attr('class');
    const pass = $(el).hasClass(expected);
    const message = () => `Expected element${pass ? ' not' : ''} to have class '${expected}', but had '${actual}'`;
    return { pass, message };
});
/**
 * expect(host.query('.zippy')).toHaveAttribute('id', 'zippy');
 */
export const toHaveAttribute = comparator((el, attr, val) => {
    if (isObject(attr)) {
        let pass = false;
        let failing;
        for (const key of Object.keys(attr)) {
            const actual = $(el).attr(key);
            const addendum = attr[key] !== undefined ? ` with value '${attr[key]}'` : '';
            pass = hasProperty(actual, attr[key]);
            failing = !pass ? `'${attr}'${addendum}, but had '${actual}'` : '';
        }
        const message = () => `Expected element${pass ? ' not' : ''} to have attribute ${failing}`;
        return { pass, message };
    }
    const actual = $(el).attr(attr);
    const addendum = val !== undefined ? ` with value '${val}'` : '';
    const pass = hasProperty(actual, val);
    const message = () => `Expected element${pass ? ' not' : ''} to have attribute '${attr}'${addendum}, but had '${actual}'`;
    return { pass, message };
});
/**
 *  expect(host.query('.checkbox')).toHaveProperty('checked', true);
 *  expect(host.query('.checkbox')).toHaveProperty({checked: true});
 */
export const toHaveProperty = comparator((el, prop, val) => {
    if (isObject(prop)) {
        return checkProperty(el, prop, hasProperty);
    }
    const actual = $(el).prop(prop);
    const addendum = val !== undefined ? ` with value '${val}'` : '';
    const pass = hasProperty(actual, val);
    const message = () => `Expected element${pass ? ' not' : ''} to have property '${prop}'${addendum}, but had '${actual}'`;
    return { pass, message };
});
export const toContainProperty = comparator((el, prop, val) => {
    if (isObject(prop)) {
        return checkProperty(el, prop, containsProperty);
    }
    const actual = $(el).prop(prop);
    const addendum = val !== undefined ? ` with value '${val}'` : '';
    const pass = containsProperty(actual, val);
    const message = () => `Expected element${pass ? ' not' : ''} to have property '${prop}'${addendum}, but had '${actual}'`;
    return { pass, message };
});
/**
 *
 * expect('.zippy__content').toHaveText('Content');
 * expect('.zippy__content').toHaveText(['Content A', 'Content B']);
 *
 * expect('.zippy__content').toHaveText((text) => text.includes('..');
 */
export const toHaveText = comparator((el, expected, exact = false) => hasSameText(el, expected, exact));
export const toHaveExactText = comparator((el, expected) => hasSameText(el, expected, true));
export const toContainText = toHaveText;
/**
 *
 * expect('.zippy__content').toHaveValue('value');
 * expect('.zippy__content').toHaveValue(['value a', 'value b']);
 */
export const toHaveValue = comparator((el, expected) => {
    if (expected && Array.isArray(expected)) {
        let actual;
        let pass = false;
        let failing;
        $(el).each((i, e) => {
            actual = $(e).val();
            pass = actual === expected[i];
            if (!pass) {
                failing = expected[i];
                return false;
            }
        });
        const message = () => `Expected element${pass ? ' not' : ''} to have value '${failing}', but had '${actual}'`;
        return { pass, message };
    }
    const actual = $(el).val();
    const pass = actual === expected;
    const message = () => `Expected element${pass ? ' not' : ''} to have value '${expected}', but had '${actual}'`;
    return { pass, message };
});
export const toContainValue = toHaveValue;
/**
 *
 *  expect(host.element).toHaveStyle({
 *    backgroundColor: 'rgba(0, 0, 0, 0.1)'
 *  });
 */
export const toHaveStyle = comparator((el, expected) => {
    const pass = hasCss(el, expected);
    const message = () => `Expected element${pass ? ' not' : ''} to have CSS ${JSON.stringify(expected)}`;
    return { pass, message };
});
/**
 *
 * expect('.zippy__content').toHaveData({data: 'role', val: 'admin'});
 */
export const toHaveData = comparator((el, { data, val }) => {
    const actual = $(el).data(data);
    const addendum = val !== undefined ? ` with value '${val}'` : '';
    const pass = hasProperty(actual, val);
    const message = () => `Expected element${pass ? ' not' : ''} to have data '${data}'${addendum}, but had '${actual}'`;
    return { pass, message };
});
/**
 *
 * expect('.checkbox').toBeChecked();
 */
export const toBeChecked = comparator((el) => {
    const pass = $(el).is(':checked');
    const message = () => `Expected element${pass ? ' not' : ''} to be checked`;
    return { pass, message };
});
/**
 *
 * expect('.checkbox').toBeDisabled();
 */
export const toBeDisabled = comparator((el) => {
    const pass = $(el).is(':disabled');
    const message = () => `Expected element${pass ? ' not' : ''} to be disabled`;
    return { pass, message };
});
/**
 * An empty element is an element without child elements or text.
 *
 * expect('div').toBeEmpty();
 */
export const toBeEmpty = comparator((el) => {
    const pass = $(el).is(':empty');
    const message = () => `Expected element${pass ? ' not' : ''} to be empty`;
    return { pass, message };
});
/**
 * Verify if an object has some expected properties.
 *
 * const actual = { lorem: 'first', ipsum: 'second' };
 * expect(actual).toBePartial({ lorem: 'first' });
 */
export const toBePartial = comparator((actual, expected) => {
    const mapToPropsAndValues = (values, properties) => {
        return properties.map((prop) => {
            return {
                name: prop,
                value: values[prop],
                type: typeof values[prop],
            };
        });
    };
    const actualProps = Object.getOwnPropertyNames(actual);
    const actualPropsAndValues = mapToPropsAndValues(actual, actualProps);
    const expectedProps = Object.getOwnPropertyNames(expected);
    const expectedPropsAndValues = mapToPropsAndValues(expected, expectedProps);
    const pass = expectedProps.every((expectedProp) => actual[expectedProp] === expected[expectedProp]);
    const message = () => `Expected element${pass ? ' not' : ''} to contain properties: ${JSON.stringify(expectedPropsAndValues)}.`.concat(` Actual properties: ${JSON.stringify(actualPropsAndValues)}`);
    return { pass, message };
});
/**
 * Hidden elements are elements that have:
 * 1. Display property set to "none"
 * 2. Width and height set to 0 (check not applied in jest)
 * 3. A hidden parent element (this also hides child elements)
 * 4. Type equal to "hidden" (only for form elements)
 * 5. A "hidden" attribute
 */
function isHidden(elOrSelector) {
    let el = $(elOrSelector)[0];
    if (!el) {
        return true;
    }
    const hiddenWhen = [
        (el) => !(el.offsetWidth || el.offsetHeight || el.getClientRects().length),
        (el) => el.style.display === 'none',
        (el) => el.style.visibility === 'hidden',
        (el) => el.type === 'hidden',
        (el) => el.hasAttribute('hidden'),
    ];
    if (isRunningInJsDom()) {
        // When running in JSDOM (Jest), offset-properties and client rects are always reported as 0
        // - hence, let's take a more "naive" approach here. (https://github.com/jsdom/jsdom/issues/135)
        hiddenWhen.shift();
    }
    while (el) {
        if (el === document) {
            break;
        }
        if (hiddenWhen.some((rule) => rule(el))) {
            return true;
        }
        el = el.parentNode;
    }
    return false;
}
/**
 * Hidden elements are elements that have:
 * 1. Display property set to "none"
 * 2. Width and height set to 0
 * 3. A hidden parent element (this also hides child elements)
 * 4. Type equal to "hidden" (only for form elements)
 * 5. A "hidden" attribute
 *
 * expect('div').toBeHidden();
 *
 */
export const toBeHidden = comparator((el) => {
    const pass = isHidden(el);
    const message = () => `Expected element${pass ? ' not' : ''} to be hidden`;
    return { pass, message };
});
/**
 * The :selected selector selects option elements that are pre-selected.
 *
 * expect('div').toBeSelected();
 *
 */
export const toBeSelected = comparator((el) => {
    const pass = $(el).is(':selected');
    const message = () => `Expected element${pass ? ' not' : ''} to be selected`;
    return { pass, message };
});
/**
 * Hidden elements are elements that have:
 * 1. Display property set to "none"
 * 2. Width and height set to 0
 * 3. A hidden parent element (this also hides child elements)
 * 4. Type equal to "hidden" (only for form elements)
 * 5. A "hidden" attribute
 *
 * expect('div').toBeVisible();
 *
 */
export const toBeVisible = comparator((el) => {
    const pass = !isHidden(el);
    const message = () => `Expected element${pass ? ' not' : ''} to be visible`;
    return { pass, message };
});
/**
 * The :focus selector selects the element that currently has focus.
 *
 * expect('input').toBeFocused();
 */
export const toBeFocused = comparator((el) => {
    const element = $(el).get(0);
    const pass = element === element.ownerDocument.activeElement;
    const message = () => `Expected element${pass ? ' not' : ''} to be focused`;
    return { pass, message };
});
/**
 * Check to see if the set of matched elements matches the given selector
 * returns true if the dom contains the element
 *
 * expect('div').toBeMatchedBy('.js-something')
 */
export const toBeMatchedBy = comparator((el, expected) => {
    const actual = $(el).filter(expected).length;
    const pass = actual > 0;
    const message = () => `Expected element${pass ? ' not' : ''} to be matched by '${expected}'`;
    return { pass, message };
});
/**
 *
 * expect('div').toHaveDescendant('.child')
 */
export const toHaveDescendant = comparator((el, selector) => {
    const actual = $(el).find(selector).length;
    const pass = actual > 0;
    const message = () => `Expected element${pass ? ' not' : ''} to contain child '${selector}'`;
    return { pass, message };
});
/**
 *
 * expect('div').toHaveDescendantWithText({selector: '.child', text: 'text'})
 */
export const toHaveDescendantWithText = comparator((el, { selector, text }) => {
    const actual = $.trim($(el).find(selector).text());
    if (text && $.isFunction(text.test)) {
        const pass = text.test(actual);
        const message = () => `Expected element${pass ? ' not' : ''} to have descendant '${selector}' with text matching '${text}',` + ` but had '${actual}'`;
        return { pass, message };
    }
    const pass = actual.indexOf(text) !== -1;
    const message = () => `Expected element${pass ? ' not' : ''} to have descendant '${selector}' with text '${text}', but had '${actual}'`;
    return { pass, message };
});
export const toHaveSelectedOptions = comparator((el, expected) => {
    if (expected instanceof HTMLOptionElement) {
        const actual = $(el).find(':selected');
        const pass = actual.is($(expected));
        const message = () => `Expected element${pass ? ' not' : ''} to have options '[${expected.outerHTML}]' but had '[${actual[0].outerHTML}]'`;
        return { pass, message };
    }
    if (isHTMLOptionElementArray(expected)) {
        const actual = $(el).find(':selected');
        const pass = actual.length === expected.length && actual.toArray().every((_, index) => $(actual[index]).is(expected[index]));
        const expectedOptionsString = $(expected)
            .get()
            .map((option) => option.outerHTML)
            .join(',');
        const actualOptionsString = actual
            .get()
            .map((option) => option.outerHTML)
            .join(',');
        const message = () => `Expected element${pass ? ' not' : ''} to have options '[${expectedOptionsString}]' but had '[${actualOptionsString}]'`;
        return { pass, message };
    }
    const actual = $(el).val();
    const pass = coerceArray(expected)?.every((v) => actual.includes(v));
    const expectedOptionsString = Array.isArray(expected)
        ? expected.reduce((acc, val, i) => acc + `${i === expected.length ? '' : ','}${val}`)
        : expected;
    const message = () => `Expected element${pass ? ' not' : ''} to have options '[${expectedOptionsString}]' but had '[${actual}]'`;
    return { pass, message };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF0Y2hlcnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9wcm9qZWN0cy9zcGVjdGF0b3Ivc3JjL2xpYi9tYXRjaGVycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSwrR0FBK0c7QUFDL0csNERBQTREO0FBRTVELE9BQU8sQ0FBQyxNQUFNLFFBQVEsQ0FBQztBQUV2QixPQUFPLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUM5RCxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsUUFBUSxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBQzdELE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxXQUFXLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFleEQsTUFBTSxXQUFXLEdBQUcsQ0FBQyxNQUFlLEVBQUUsUUFBaUIsRUFBVyxFQUFFO0lBQ2xFLE9BQU8sUUFBUSxLQUFLLFNBQVMsQ0FBQyxDQUFDLENBQUMsTUFBTSxLQUFLLFNBQVMsQ0FBQyxDQUFDLENBQUMsTUFBTSxLQUFLLFFBQVEsQ0FBQztBQUM3RSxDQUFDLENBQUM7QUFFRixNQUFNLGdCQUFnQixHQUFHLENBQUMsTUFBYyxFQUFFLFFBQWlCLEVBQVcsRUFBRTtJQUN0RSxPQUFPLFFBQVEsS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxRQUFrQixDQUFDLENBQUM7QUFDN0UsQ0FBQyxDQUFDO0FBRUYsTUFBTSxhQUFhLEdBQUcsQ0FDcEIsRUFBZSxFQUNmLElBQVksRUFDWixTQUF3QyxFQUNFLEVBQUU7SUFDNUMsSUFBSSxJQUFJLEdBQUcsS0FBSyxDQUFDO0lBQ2pCLElBQUksT0FBTyxHQUFHLEVBQUUsQ0FBQztJQUVqQixLQUFLLE1BQU0sR0FBRyxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDbkMsTUFBTSxNQUFNLEdBQUcsQ0FBQyxD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RUFBRSxDQUFDO0FBQzNCLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqIENyZWRpdDogaHR0cHM6Ly9naXRodWIuY29tL3VuaW5kZW50ZWQvY3VzdG9tLWpxdWVyeS1tYXRjaGVycy90cmVlL21hc3Rlci9wYWNrYWdlcy9jdXN0b20tanF1ZXJ5LW1hdGNoZXJzICovXG4vKiBlc2xpbnQtZGlzYWJsZSBuby1zaGFkb3csIEB0eXBlc2NyaXB0LWVzbGludC9uby1zaGFkb3cgKi9cblxuaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcblxuaW1wb3J0IHsgaGV4MnJnYiwgaXNIZXgsIHRyaW0gfSBmcm9tICcuL2ludGVybmFscy9yZ2ItdG8taGV4JztcbmltcG9ydCB7IGlzSFRNTE9wdGlvbkVsZW1lbnRBcnJheSwgaXNPYmplY3QgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IGlzUnVubmluZ0luSnNEb20sIGNvZXJjZUFycmF5IH0gZnJvbSAnLi91dGlscyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3VzdG9tTWF0Y2hlckZhY3Rvcnkge1xuICAoKTogQ3VzdG9tTWF0Y2hlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDdXN0b21NYXRjaGVyIHtcbiAgY29tcGFyZTxUPihhY3R1YWw6IFQsIGV4cGVjdGVkOiBULCAuLi5hcmdzOiBhbnlbXSk6IEN1c3RvbU1hdGNoZXJSZXN1bHQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3VzdG9tTWF0Y2hlclJlc3VsdCB7XG4gIHBhc3M6IGJvb2xlYW47XG4gIG1lc3NhZ2U6ICgpID0+IHN0cmluZztcbn1cblxuY29uc3QgaGFzUHJvcGVydHkgPSAoYWN0dWFsOiB1bmtub3duLCBleHBlY3RlZDogdW5rbm93bik6IGJvb2xlYW4gPT4ge1xuICByZXR1cm4gZXhwZWN0ZWQgPT09IHVuZGVmaW5lZCA/IGFjdHVhbCAhPT0gdW5kZWZpbmVkIDogYWN0dWFsID09PSBleHBlY3RlZDtcbn07XG5cbmNvbnN0IGNvbnRhaW5zUHJvcGVydHkgPSAoYWN0dWFsOiBzdHJpbmcsIGV4cGVjdGVkOiB1bmtub3duKTogYm9vbGVhbiA9PiB7XG4gIHJldHVybiBleHBlY3RlZCA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6IGFjdHVhbC5pbmNsdWRlcyhleHBlY3RlZCBhcyBzdHJpbmcpO1xufTtcblxuY29uc3QgY2hlY2tQcm9wZXJ0eSA9IChcbiAgZWw6IEhUTUxFbGVtZW50LFxuICBwcm9wOiBvYmplY3QsXG4gIHByZWRpY2F0ZTogKGFjdHVhbCwgZXhwZWN0ZWQpID0+IGJvb2xlYW5cbik6IHsgcGFzczogYm9vbGVhbjsgbWVzc2FnZTogKCkgPT4gc3RyaW5nIH0gPT4ge1xuICBsZXQgcGFzcyA9IGZhbHNlO1xuICBsZXQgZmFpbGluZyA9ICcnO1xuXG4gIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKHByb3ApKSB7XG4gICAgY29uc3QgYWN0dWFsID0gJChlbCkucHJvcChrZXkpO1xuICAgIGNvbnN0IGFkZGVuZHVtID0gcHJvcFtrZXldICE9PSB1bmRlZmluZWQgPyBgIHdpdGggdmFsdWUgJyR7cHJvcFtrZXldfSdgIDogJyc7XG5cbiAgICBwYXNzID0gcHJlZGljYXRlKGFjdHVhbCwgcHJvcFtrZXldKTtcbiAgICBmYWlsaW5nID0gIXBhc3MgPyBgJyR7cHJvcH0nJHthZGRlbmR1bX0sIGJ1dCBoYWQgJyR7YWN0dWFsfSdgIDogJyc7XG4gIH1cblxuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSBwcm9wZXJ0eSAke2ZhaWxpbmd9YDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59O1xuXG5jb25zdCBoYXNDc3MgPSAoZWw6IEhUTUxFbGVtZW50LCBjc3M6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0pID0+IHtcbiAgbGV0IHByb3A7XG4gIGxldCB2YWx1ZTtcbiAgY29uc3QgJGVsID0gJChlbCk7XG4gIGZvciAocHJvcCBpbiBjc3MpIHtcbiAgICBpZiAoY3NzLmhhc093blByb3BlcnR5KHByb3ApKSB7XG4gICAgICB2YWx1ZSA9IGNzc1twcm9wXTtcblxuICAgICAgaWYgKGlzSGV4KHZhbHVlKSkge1xuICAgICAgICB2YWx1ZSA9IGhleDJyZ2IoY3NzW3Byb3BdKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHZhbHVlID09PSAnYXV0bycgJiYgJGVsLmdldCgwKS5zdHlsZVtwcm9wXSA9PT0gJ2F1dG8nKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAodHJpbSgkZWwuZ2V0KDApLnN0eWxlW3Byb3BdKSAhPT0gdHJpbSh2YWx1ZSkgJiYgdHJpbShlbC5zdHlsZVtwcm9wXSkgIT09IHRyaW0odmFsdWUpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn07XG5cbmNvbnN0IGhhc1NhbWVUZXh0ID0gKGVsOiBIVE1MRWxlbWVudCwgZXhwZWN0ZWQ6IHN0cmluZyB8IHN0cmluZ1tdIHwgKChzOiBzdHJpbmcpID0+IGJvb2xlYW4pLCBleGFjdCA9IGZhbHNlKSA9PiB7XG4gIGlmIChleHBlY3RlZCAmJiBBcnJheS5pc0FycmF5KGV4cGVjdGVkKSkge1xuICAgIGxldCBhY3R1YWw6IHN0cmluZztcbiAgICBsZXQgcGFzcyA9IGZhbHNlO1xuICAgIGxldCBmYWlsaW5nOiBzdHJpbmc7XG5cbiAgICAkKGVsKS5lYWNoKChpLCBlKSA9PiB7XG4gICAgICBhY3R1YWwgPSBleGFjdCA/ICQoZSkudGV4dCgpIDogJC50cmltKCQoZSkudGV4dCgpKTtcbiAgICAgIHBhc3MgPSBleGFjdCA/IGFjdHVhbCA9PT0gZXhwZWN0ZWRbaV0gOiBhY3R1YWwuaW5jbHVkZXMoZXhwZWN0ZWRbaV0pO1xuICAgICAgaWYgKCFwYXNzKSB7XG4gICAgICAgIGZhaWxpbmcgPSBleHBlY3RlZFtpXTtcblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSAke2V4YWN0ID8gJ2V4YWN0JyA6ICcnfSB0ZXh0ICcke2ZhaWxpbmd9JywgYnV0IGhhZCAnJHthY3R1YWx9J2A7XG5cbiAgICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG4gIH1cblxuICBjb25zdCBhY3R1YWwgPSBleGFjdCA/ICQoZWwpLnRleHQoKSA6ICQudHJpbSgkKGVsKS50ZXh0KCkpO1xuXG4gIGlmIChleHBlY3RlZCAmJiB0eXBlb2YgZXhwZWN0ZWQgIT09ICdzdHJpbmcnKSB7XG4gICAgY29uc3QgcGFzcyA9IGV4cGVjdGVkKGFjdHVhbCk7XG4gICAgY29uc3QgbWVzc2FnZSA9ICgpID0+XG4gICAgICBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlICR7ZXhhY3QgPyAnZXhhY3QnIDogJyd9IHRleHQgbWF0Y2hpbmcgJyR7ZXhwZWN0ZWR9JyxgICsgYCBidXQgaGFkICcke2FjdHVhbH0nYDtcblxuICAgIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbiAgfVxuXG4gIGNvbnN0IHBhc3MgPSBleGFjdCAmJiAhQXJyYXkuaXNBcnJheShleHBlY3RlZCkgPyBhY3R1YWwgPT09IGV4cGVjdGVkIDogYWN0dWFsLmluZGV4T2YoZXhwZWN0ZWQpICE9PSAtMTtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgJHtleGFjdCA/ICdleGFjdCcgOiAnJ30gdGV4dCAnJHtleHBlY3RlZH0nLCBidXQgaGFkICcke2FjdHVhbH0nYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59O1xuXG5jb25zdCBjb21wYXJhdG9yID1cbiAgKGZ1bmMpOiBDdXN0b21NYXRjaGVyRmFjdG9yeSA9PlxuICAoKSA9PiAoe1xuICAgIGNvbXBhcmU6IGZ1bmMsXG4gIH0pO1xuXG4vKipcbiAqXG4gKiBleHBlY3QoJy56aXBweV9fY29udGVudCcpLm5vdC50b0V4aXN0KCk7XG4gKi9cbmV4cG9ydCBjb25zdCB0b0V4aXN0ID0gY29tcGFyYXRvcigoZWw6IHN0cmluZyB8IEVsZW1lbnQpID0+IHtcbiAgY29uc3QgYWN0dWFsID0gJChlbCkubGVuZ3RoO1xuICBjb25zdCBwYXNzID0gYWN0dWFsID4gMDtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCAke2VsfSBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGV4aXN0YDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKlxuICogZXhwZWN0KCcuemlwcHlfX2NvbnRlbnQnKS50b0hhdmVMZW5ndGgoMyk7XG4gKi9cbmV4cG9ydCBjb25zdCB0b0hhdmVMZW5ndGggPSBjb21wYXJhdG9yKChlbDogc3RyaW5nLCBleHBlY3RlZDogbnVtYmVyKSA9PiB7XG4gIGNvbnN0IGFjdHVhbCA9ICQoZWwpLmxlbmd0aDtcbiAgY29uc3QgcGFzcyA9IGFjdHVhbCA9PT0gZXhwZWN0ZWQ7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIGxlbmd0aCAke2V4cGVjdGVkfSwgYnV0IGhhZCAke2FjdHVhbH1gO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqXG4gKiBleHBlY3QoJy56aXBweV9fY29udGVudCcpLnRvSGF2ZUlkKCdJRCcpO1xuICovXG5leHBvcnQgY29uc3QgdG9IYXZlSWQgPSBjb21wYXJhdG9yKChlbCwgZXhwZWN0ZWQpID0+IHtcbiAgY29uc3QgYWN0dWFsID0gJChlbCkuYXR0cignaWQnKTtcbiAgY29uc3QgcGFzcyA9IGFjdHVhbCA9PT0gZXhwZWN0ZWQ7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIElEICcke2V4cGVjdGVkfScsIGJ1dCBoYWQgJyR7YWN0dWFsfSdgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqIFRoaXMgdmFsaWRhdGVzIGNsYXNzZXMgaW4gc3RyaWN0IG9yZGVyLiBJZiB5b3Ugd2FudCB0byB2YWxpZGF0ZSBjbGFzc2VzIGluIGFueSBvcmRlcixcbiAqIGp1c3Qgc2V0IHRoZSBzdHJpY3QgY29uZmlnIG9wdGlvbiB0byBmYWxzZS5cbiAqXG4gKiBleHBlY3QoJy56aXBweV9fY29udGVudCcpLnRvSGF2ZUNsYXNzKCdjbGFzcycpO1xuICogZXhwZWN0KCcuemlwcHlfX2NvbnRlbnQnKS50b0hhdmVDbGFzcygnY2xhc3MtYSwgY2xhc3MtYicpO1xuICogZXhwZWN0KCcuemlwcHlfX2NvbnRlbnQnKS50b0hhdmVDbGFzcyhbJ2NsYXNzLWEsIGNsYXNzLWInXSk7XG4gKiBleHBlY3QoJy56aXBweV9fY29udGVudCcpLnRvSGF2ZUNsYXNzKFsnY2xhc3MtYiwgY2xhc3MtYSddKTtcbiAqIGV4cGVjdCgnLnppcHB5X19jb250ZW50Jykubm90LnRvSGF2ZUNsYXNzKFsnY2xhc3MtYiwgY2xhc3MtYSddLCB7IHN0cmljdDogdHJ1ZSB9KTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvSGF2ZUNsYXNzID0gY29tcGFyYXRvcigoZWwsIGV4cGVjdGVkOiBzdHJpbmcgfCBzdHJpbmdbXSwgb3B0aW9uczogeyBzdHJpY3Q6IGJvb2xlYW4gfSA9IHsgc3RyaWN0OiB0cnVlIH0pID0+IHtcbiAgaWYgKGV4cGVjdGVkICYmIEFycmF5LmlzQXJyYXkoZXhwZWN0ZWQpKSB7XG4gICAgY29uc3QgYWN0dWFsOiBzdHJpbmcgPSAkKGVsKS5hdHRyKCdjbGFzcycpO1xuICAgIGNvbnN0IGV4cGVjdGVkQ2xhc3NlcyA9IGV4cGVjdGVkLmpvaW4oJyAnKTtcbiAgICBjb25zdCBwYXNzID0gb3B0aW9ucy5zdHJpY3QgPyAkKGVsKS5oYXNDbGFzcyhleHBlY3RlZENsYXNzZXMpIDogZXhwZWN0ZWQuZXZlcnkoKGUpID0+ICQoZWwpLmhhc0NsYXNzKGUpKTtcbiAgICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSB2YWx1ZSAnJHtleHBlY3RlZENsYXNzZXN9JywgYnV0IGhhZCAnJHthY3R1YWx9J2A7XG5cbiAgICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG4gIH1cblxuICBjb25zdCBhY3R1YWwgPSAkKGVsKS5hdHRyKCdjbGFzcycpO1xuICBjb25zdCBwYXNzID0gJChlbCkuaGFzQ2xhc3MoZXhwZWN0ZWQpO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSBjbGFzcyAnJHtleHBlY3RlZH0nLCBidXQgaGFkICcke2FjdHVhbH0nYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKiBleHBlY3QoaG9zdC5xdWVyeSgnLnppcHB5JykpLnRvSGF2ZUF0dHJpYnV0ZSgnaWQnLCAnemlwcHknKTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvSGF2ZUF0dHJpYnV0ZSA9IGNvbXBhcmF0b3IoKGVsLCBhdHRyOiBzdHJpbmcgfCBvYmplY3QsIHZhbCkgPT4ge1xuICBpZiAoaXNPYmplY3QoYXR0cikpIHtcbiAgICBsZXQgcGFzcyA9IGZhbHNlO1xuICAgIGxldCBmYWlsaW5nOiBzdHJpbmc7XG5cbiAgICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhhdHRyKSkge1xuICAgICAgY29uc3QgYWN0dWFsID0gJChlbCkuYXR0cihrZXkpO1xuICAgICAgY29uc3QgYWRkZW5kdW0gPSBhdHRyW2tleV0gIT09IHVuZGVmaW5lZCA/IGAgd2l0aCB2YWx1ZSAnJHthdHRyW2tleV19J2AgOiAnJztcbiAgICAgIHBhc3MgPSBoYXNQcm9wZXJ0eShhY3R1YWwsIGF0dHJba2V5XSk7XG4gICAgICBmYWlsaW5nID0gIXBhc3MgPyBgJyR7YXR0cn0nJHthZGRlbmR1bX0sIGJ1dCBoYWQgJyR7YWN0dWFsfSdgIDogJyc7XG4gICAgfVxuICAgIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIGF0dHJpYnV0ZSAke2ZhaWxpbmd9YDtcblxuICAgIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbiAgfVxuXG4gIGNvbnN0IGFjdHVhbCA9ICQoZWwpLmF0dHIoYXR0cik7XG4gIGNvbnN0IGFkZGVuZHVtID0gdmFsICE9PSB1bmRlZmluZWQgPyBgIHdpdGggdmFsdWUgJyR7dmFsfSdgIDogJyc7XG4gIGNvbnN0IHBhc3MgPSBoYXNQcm9wZXJ0eShhY3R1YWwsIHZhbCk7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIGF0dHJpYnV0ZSAnJHthdHRyfScke2FkZGVuZHVtfSwgYnV0IGhhZCAnJHthY3R1YWx9J2A7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICogIGV4cGVjdChob3N0LnF1ZXJ5KCcuY2hlY2tib3gnKSkudG9IYXZlUHJvcGVydHkoJ2NoZWNrZWQnLCB0cnVlKTtcbiAqICBleHBlY3QoaG9zdC5xdWVyeSgnLmNoZWNrYm94JykpLnRvSGF2ZVByb3BlcnR5KHtjaGVja2VkOiB0cnVlfSk7XG4gKi9cbmV4cG9ydCBjb25zdCB0b0hhdmVQcm9wZXJ0eSA9IGNvbXBhcmF0b3IoKGVsLCBwcm9wLCB2YWwpID0+IHtcbiAgaWYgKGlzT2JqZWN0KHByb3ApKSB7XG4gICAgcmV0dXJuIGNoZWNrUHJvcGVydHkoZWwsIHByb3AsIGhhc1Byb3BlcnR5KTtcbiAgfVxuXG4gIGNvbnN0IGFjdHVhbCA9ICQoZWwpLnByb3AocHJvcCk7XG4gIGNvbnN0IGFkZGVuZHVtID0gdmFsICE9PSB1bmRlZmluZWQgPyBgIHdpdGggdmFsdWUgJyR7dmFsfSdgIDogJyc7XG4gIGNvbnN0IHBhc3MgPSBoYXNQcm9wZXJ0eShhY3R1YWwsIHZhbCk7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIHByb3BlcnR5ICcke3Byb3B9JyR7YWRkZW5kdW19LCBidXQgaGFkICcke2FjdHVhbH0nYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuZXhwb3J0IGNvbnN0IHRvQ29udGFpblByb3BlcnR5ID0gY29tcGFyYXRvcigoZWwsIHByb3AsIHZhbCkgPT4ge1xuICBpZiAoaXNPYmplY3QocHJvcCkpIHtcbiAgICByZXR1cm4gY2hlY2tQcm9wZXJ0eShlbCwgcHJvcCwgY29udGFpbnNQcm9wZXJ0eSk7XG4gIH1cblxuICBjb25zdCBhY3R1YWwgPSAkKGVsKS5wcm9wKHByb3ApO1xuICBjb25zdCBhZGRlbmR1bSA9IHZhbCAhPT0gdW5kZWZpbmVkID8gYCB3aXRoIHZhbHVlICcke3ZhbH0nYCA6ICcnO1xuICBjb25zdCBwYXNzID0gY29udGFpbnNQcm9wZXJ0eShhY3R1YWwsIHZhbCk7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIHByb3BlcnR5ICcke3Byb3B9JyR7YWRkZW5kdW19LCBidXQgaGFkICcke2FjdHVhbH0nYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKlxuICogZXhwZWN0KCcuemlwcHlfX2NvbnRlbnQnKS50b0hhdmVUZXh0KCdDb250ZW50Jyk7XG4gKiBleHBlY3QoJy56aXBweV9fY29udGVudCcpLnRvSGF2ZVRleHQoWydDb250ZW50IEEnLCAnQ29udGVudCBCJ10pO1xuICpcbiAqIGV4cGVjdCgnLnppcHB5X19jb250ZW50JykudG9IYXZlVGV4dCgodGV4dCkgPT4gdGV4dC5pbmNsdWRlcygnLi4nKTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvSGF2ZVRleHQgPSBjb21wYXJhdG9yKChlbCwgZXhwZWN0ZWQsIGV4YWN0ID0gZmFsc2UpID0+IGhhc1NhbWVUZXh0KGVsLCBleHBlY3RlZCwgZXhhY3QpKTtcblxuZXhwb3J0IGNvbnN0IHRvSGF2ZUV4YWN0VGV4dCA9IGNvbXBhcmF0b3IoKGVsLCBleHBlY3RlZCkgPT4gaGFzU2FtZVRleHQoZWwsIGV4cGVjdGVkLCB0cnVlKSk7XG5cbmV4cG9ydCBjb25zdCB0b0NvbnRhaW5UZXh0ID0gdG9IYXZlVGV4dDtcblxuLyoqXG4gKlxuICogZXhwZWN0KCcuemlwcHlfX2NvbnRlbnQnKS50b0hhdmVWYWx1ZSgndmFsdWUnKTtcbiAqIGV4cGVjdCgnLnppcHB5X19jb250ZW50JykudG9IYXZlVmFsdWUoWyd2YWx1ZSBhJywgJ3ZhbHVlIGInXSk7XG4gKi9cbmV4cG9ydCBjb25zdCB0b0hhdmVWYWx1ZSA9IGNvbXBhcmF0b3IoKGVsLCBleHBlY3RlZCkgPT4ge1xuICBpZiAoZXhwZWN0ZWQgJiYgQXJyYXkuaXNBcnJheShleHBlY3RlZCkpIHtcbiAgICBsZXQgYWN0dWFsOiBzdHJpbmc7XG4gICAgbGV0IHBhc3MgPSBmYWxzZTtcbiAgICBsZXQgZmFpbGluZzogc3RyaW5nO1xuXG4gICAgJChlbCkuZWFjaCgoaSwgZSkgPT4ge1xuICAgICAgYWN0dWFsID0gJChlKS52YWwoKTtcbiAgICAgIHBhc3MgPSBhY3R1YWwgPT09IGV4cGVjdGVkW2ldO1xuICAgICAgaWYgKCFwYXNzKSB7XG4gICAgICAgIGZhaWxpbmcgPSBleHBlY3RlZFtpXTtcblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSB2YWx1ZSAnJHtmYWlsaW5nfScsIGJ1dCBoYWQgJyR7YWN0dWFsfSdgO1xuXG4gICAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xuICB9XG5cbiAgY29uc3QgYWN0dWFsID0gJChlbCkudmFsKCk7XG4gIGNvbnN0IHBhc3MgPSBhY3R1YWwgPT09IGV4cGVjdGVkO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gaGF2ZSB2YWx1ZSAnJHtleHBlY3RlZH0nLCBidXQgaGFkICcke2FjdHVhbH0nYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuZXhwb3J0IGNvbnN0IHRvQ29udGFpblZhbHVlID0gdG9IYXZlVmFsdWU7XG5cbi8qKlxuICpcbiAqICBleHBlY3QoaG9zdC5lbGVtZW50KS50b0hhdmVTdHlsZSh7XG4gKiAgICBiYWNrZ3JvdW5kQ29sb3I6ICdyZ2JhKDAsIDAsIDAsIDAuMSknXG4gKiAgfSk7XG4gKi9cbmV4cG9ydCBjb25zdCB0b0hhdmVTdHlsZSA9IGNvbXBhcmF0b3IoKGVsLCBleHBlY3RlZCkgPT4ge1xuICBjb25zdCBwYXNzID0gaGFzQ3NzKGVsLCBleHBlY3RlZCk7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIENTUyAke0pTT04uc3RyaW5naWZ5KGV4cGVjdGVkKX1gO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqXG4gKiBleHBlY3QoJy56aXBweV9fY29udGVudCcpLnRvSGF2ZURhdGEoe2RhdGE6ICdyb2xlJywgdmFsOiAnYWRtaW4nfSk7XG4gKi9cbmV4cG9ydCBjb25zdCB0b0hhdmVEYXRhID0gY29tcGFyYXRvcigoZWwsIHsgZGF0YSwgdmFsIH0pID0+IHtcbiAgY29uc3QgYWN0dWFsID0gJChlbCkuZGF0YShkYXRhKTtcbiAgY29uc3QgYWRkZW5kdW0gPSB2YWwgIT09IHVuZGVmaW5lZCA/IGAgd2l0aCB2YWx1ZSAnJHt2YWx9J2AgOiAnJztcbiAgY29uc3QgcGFzcyA9IGhhc1Byb3BlcnR5KGFjdHVhbCwgdmFsKTtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgZGF0YSAnJHtkYXRhfScke2FkZGVuZHVtfSwgYnV0IGhhZCAnJHthY3R1YWx9J2A7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICpcbiAqIGV4cGVjdCgnLmNoZWNrYm94JykudG9CZUNoZWNrZWQoKTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvQmVDaGVja2VkID0gY29tcGFyYXRvcigoZWwpID0+IHtcbiAgY29uc3QgcGFzcyA9ICQoZWwpLmlzKCc6Y2hlY2tlZCcpO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gYmUgY2hlY2tlZGA7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICpcbiAqIGV4cGVjdCgnLmNoZWNrYm94JykudG9CZURpc2FibGVkKCk7XG4gKi9cbmV4cG9ydCBjb25zdCB0b0JlRGlzYWJsZWQgPSBjb21wYXJhdG9yKChlbCkgPT4ge1xuICBjb25zdCBwYXNzID0gJChlbCkuaXMoJzpkaXNhYmxlZCcpO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gYmUgZGlzYWJsZWRgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqIEFuIGVtcHR5IGVsZW1lbnQgaXMgYW4gZWxlbWVudCB3aXRob3V0IGNoaWxkIGVsZW1lbnRzIG9yIHRleHQuXG4gKlxuICogZXhwZWN0KCdkaXYnKS50b0JlRW1wdHkoKTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvQmVFbXB0eSA9IGNvbXBhcmF0b3IoKGVsKSA9PiB7XG4gIGNvbnN0IHBhc3MgPSAkKGVsKS5pcygnOmVtcHR5Jyk7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBiZSBlbXB0eWA7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICogVmVyaWZ5IGlmIGFuIG9iamVjdCBoYXMgc29tZSBleHBlY3RlZCBwcm9wZXJ0aWVzLlxuICpcbiAqIGNvbnN0IGFjdHVhbCA9IHsgbG9yZW06ICdmaXJzdCcsIGlwc3VtOiAnc2Vjb25kJyB9O1xuICogZXhwZWN0KGFjdHVhbCkudG9CZVBhcnRpYWwoeyBsb3JlbTogJ2ZpcnN0JyB9KTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvQmVQYXJ0aWFsID0gY29tcGFyYXRvcigoYWN0dWFsLCBleHBlY3RlZCkgPT4ge1xuICBjb25zdCBtYXBUb1Byb3BzQW5kVmFsdWVzID0gKHZhbHVlczogYW55W10sIHByb3BlcnRpZXM6IGFueVtdKSA9PiB7XG4gICAgcmV0dXJuIHByb3BlcnRpZXMubWFwKChwcm9wKSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBuYW1lOiBwcm9wLFxuICAgICAgICB2YWx1ZTogdmFsdWVzW3Byb3BdLFxuICAgICAgICB0eXBlOiB0eXBlb2YgdmFsdWVzW3Byb3BdLFxuICAgICAgfTtcbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgYWN0dWFsUHJvcHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhhY3R1YWwpO1xuICBjb25zdCBhY3R1YWxQcm9wc0FuZFZhbHVlcyA9IG1hcFRvUHJvcHNBbmRWYWx1ZXMoYWN0dWFsLCBhY3R1YWxQcm9wcyk7XG5cbiAgY29uc3QgZXhwZWN0ZWRQcm9wcyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGV4cGVjdGVkKTtcbiAgY29uc3QgZXhwZWN0ZWRQcm9wc0FuZFZhbHVlcyA9IG1hcFRvUHJvcHNBbmRWYWx1ZXMoZXhwZWN0ZWQsIGV4cGVjdGVkUHJvcHMpO1xuXG4gIGNvbnN0IHBhc3MgPSBleHBlY3RlZFByb3BzLmV2ZXJ5KChleHBlY3RlZFByb3ApID0+IGFjdHVhbFtleHBlY3RlZFByb3BdID09PSBleHBlY3RlZFtleHBlY3RlZFByb3BdKTtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+XG4gICAgYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gY29udGFpbiBwcm9wZXJ0aWVzOiAke0pTT04uc3RyaW5naWZ5KGV4cGVjdGVkUHJvcHNBbmRWYWx1ZXMpfS5gLmNvbmNhdChcbiAgICAgIGAgQWN0dWFsIHByb3BlcnRpZXM6ICR7SlNPTi5zdHJpbmdpZnkoYWN0dWFsUHJvcHNBbmRWYWx1ZXMpfWBcbiAgICApO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqIEhpZGRlbiBlbGVtZW50cyBhcmUgZWxlbWVudHMgdGhhdCBoYXZlOlxuICogMS4gRGlzcGxheSBwcm9wZXJ0eSBzZXQgdG8gXCJub25lXCJcbiAqIDIuIFdpZHRoIGFuZCBoZWlnaHQgc2V0IHRvIDAgKGNoZWNrIG5vdCBhcHBsaWVkIGluIGplc3QpXG4gKiAzLiBBIGhpZGRlbiBwYXJlbnQgZWxlbWVudCAodGhpcyBhbHNvIGhpZGVzIGNoaWxkIGVsZW1lbnRzKVxuICogNC4gVHlwZSBlcXVhbCB0byBcImhpZGRlblwiIChvbmx5IGZvciBmb3JtIGVsZW1lbnRzKVxuICogNS4gQSBcImhpZGRlblwiIGF0dHJpYnV0ZVxuICovXG5mdW5jdGlvbiBpc0hpZGRlbihlbE9yU2VsZWN0b3I6IEhUTUxFbGVtZW50IHwgc3RyaW5nKTogYm9vbGVhbiB7XG4gIGxldCBlbCA9ICQoZWxPclNlbGVjdG9yKVswXTtcblxuICBpZiAoIWVsKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBjb25zdCBoaWRkZW5XaGVuID0gW1xuICAgIChlbCkgPT4gIShlbC5vZmZzZXRXaWR0aCB8fCBlbC5vZmZzZXRIZWlnaHQgfHwgZWwuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGgpLFxuICAgIChlbCkgPT4gZWwuc3R5bGUuZGlzcGxheSA9PT0gJ25vbmUnLFxuICAgIChlbCkgPT4gZWwuc3R5bGUudmlzaWJpbGl0eSA9PT0gJ2hpZGRlbicsXG4gICAgKGVsKSA9PiBlbC50eXBlID09PSAnaGlkZGVuJyxcbiAgICAoZWwpID0+IGVsLmhhc0F0dHJpYnV0ZSgnaGlkZGVuJyksXG4gIF07XG5cbiAgaWYgKGlzUnVubmluZ0luSnNEb20oKSkge1xuICAgIC8vIFdoZW4gcnVubmluZyBpbiBKU0RPTSAoSmVzdCksIG9mZnNldC1wcm9wZXJ0aWVzIGFuZCBjbGllbnQgcmVjdHMgYXJlIGFsd2F5cyByZXBvcnRlZCBhcyAwXG4gICAgLy8gLSBoZW5jZSwgbGV0J3MgdGFrZSBhIG1vcmUgXCJuYWl2ZVwiIGFwcHJvYWNoIGhlcmUuIChodHRwczovL2dpdGh1Yi5jb20vanNkb20vanNkb20vaXNzdWVzLzEzNSlcbiAgICBoaWRkZW5XaGVuLnNoaWZ0KCk7XG4gIH1cblxuICB3aGlsZSAoZWwpIHtcbiAgICBpZiAoZWwgPT09IGRvY3VtZW50KSB7XG4gICAgICBicmVhaztcbiAgICB9XG5cbiAgICBpZiAoaGlkZGVuV2hlbi5zb21lKChydWxlKSA9PiBydWxlKGVsKSkpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGVsID0gZWwucGFyZW50Tm9kZTtcbiAgfVxuXG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBIaWRkZW4gZWxlbWVudHMgYXJlIGVsZW1lbnRzIHRoYXQgaGF2ZTpcbiAqIDEuIERpc3BsYXkgcHJvcGVydHkgc2V0IHRvIFwibm9uZVwiXG4gKiAyLiBXaWR0aCBhbmQgaGVpZ2h0IHNldCB0byAwXG4gKiAzLiBBIGhpZGRlbiBwYXJlbnQgZWxlbWVudCAodGhpcyBhbHNvIGhpZGVzIGNoaWxkIGVsZW1lbnRzKVxuICogNC4gVHlwZSBlcXVhbCB0byBcImhpZGRlblwiIChvbmx5IGZvciBmb3JtIGVsZW1lbnRzKVxuICogNS4gQSBcImhpZGRlblwiIGF0dHJpYnV0ZVxuICpcbiAqIGV4cGVjdCgnZGl2JykudG9CZUhpZGRlbigpO1xuICpcbiAqL1xuZXhwb3J0IGNvbnN0IHRvQmVIaWRkZW4gPSBjb21wYXJhdG9yKChlbCkgPT4ge1xuICBjb25zdCBwYXNzID0gaXNIaWRkZW4oZWwpO1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gYmUgaGlkZGVuYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuLyoqXG4gKiBUaGUgOnNlbGVjdGVkIHNlbGVjdG9yIHNlbGVjdHMgb3B0aW9uIGVsZW1lbnRzIHRoYXQgYXJlIHByZS1zZWxlY3RlZC5cbiAqXG4gKiBleHBlY3QoJ2RpdicpLnRvQmVTZWxlY3RlZCgpO1xuICpcbiAqL1xuZXhwb3J0IGNvbnN0IHRvQmVTZWxlY3RlZCA9IGNvbXBhcmF0b3IoKGVsKSA9PiB7XG4gIGNvbnN0IHBhc3MgPSAkKGVsKS5pcygnOnNlbGVjdGVkJyk7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBiZSBzZWxlY3RlZGA7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICogSGlkZGVuIGVsZW1lbnRzIGFyZSBlbGVtZW50cyB0aGF0IGhhdmU6XG4gKiAxLiBEaXNwbGF5IHByb3BlcnR5IHNldCB0byBcIm5vbmVcIlxuICogMi4gV2lkdGggYW5kIGhlaWdodCBzZXQgdG8gMFxuICogMy4gQSBoaWRkZW4gcGFyZW50IGVsZW1lbnQgKHRoaXMgYWxzbyBoaWRlcyBjaGlsZCBlbGVtZW50cylcbiAqIDQuIFR5cGUgZXF1YWwgdG8gXCJoaWRkZW5cIiAob25seSBmb3IgZm9ybSBlbGVtZW50cylcbiAqIDUuIEEgXCJoaWRkZW5cIiBhdHRyaWJ1dGVcbiAqXG4gKiBleHBlY3QoJ2RpdicpLnRvQmVWaXNpYmxlKCk7XG4gKlxuICovXG5leHBvcnQgY29uc3QgdG9CZVZpc2libGUgPSBjb21wYXJhdG9yKChlbCkgPT4ge1xuICBjb25zdCBwYXNzID0gIWlzSGlkZGVuKGVsKTtcblxuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gYmUgdmlzaWJsZWA7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICogVGhlIDpmb2N1cyBzZWxlY3RvciBzZWxlY3RzIHRoZSBlbGVtZW50IHRoYXQgY3VycmVudGx5IGhhcyBmb2N1cy5cbiAqXG4gKiBleHBlY3QoJ2lucHV0JykudG9CZUZvY3VzZWQoKTtcbiAqL1xuZXhwb3J0IGNvbnN0IHRvQmVGb2N1c2VkID0gY29tcGFyYXRvcigoZWwpID0+IHtcbiAgY29uc3QgZWxlbWVudCA9ICQoZWwpLmdldCgwKTtcbiAgY29uc3QgcGFzcyA9IGVsZW1lbnQgPT09IGVsZW1lbnQub3duZXJEb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICBjb25zdCBtZXNzYWdlID0gKCkgPT4gYEV4cGVjdGVkIGVsZW1lbnQke3Bhc3MgPyAnIG5vdCcgOiAnJ30gdG8gYmUgZm9jdXNlZGA7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG5cbi8qKlxuICogQ2hlY2sgdG8gc2VlIGlmIHRoZSBzZXQgb2YgbWF0Y2hlZCBlbGVtZW50cyBtYXRjaGVzIHRoZSBnaXZlbiBzZWxlY3RvclxuICogcmV0dXJucyB0cnVlIGlmIHRoZSBkb20gY29udGFpbnMgdGhlIGVsZW1lbnRcbiAqXG4gKiBleHBlY3QoJ2RpdicpLnRvQmVNYXRjaGVkQnkoJy5qcy1zb21ldGhpbmcnKVxuICovXG5leHBvcnQgY29uc3QgdG9CZU1hdGNoZWRCeSA9IGNvbXBhcmF0b3IoKGVsLCBleHBlY3RlZCkgPT4ge1xuICBjb25zdCBhY3R1YWwgPSAkKGVsKS5maWx0ZXIoZXhwZWN0ZWQpLmxlbmd0aDtcbiAgY29uc3QgcGFzcyA9IGFjdHVhbCA+IDA7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBiZSBtYXRjaGVkIGJ5ICcke2V4cGVjdGVkfSdgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqXG4gKiBleHBlY3QoJ2RpdicpLnRvSGF2ZURlc2NlbmRhbnQoJy5jaGlsZCcpXG4gKi9cbmV4cG9ydCBjb25zdCB0b0hhdmVEZXNjZW5kYW50ID0gY29tcGFyYXRvcigoZWwsIHNlbGVjdG9yKSA9PiB7XG4gIGNvbnN0IGFjdHVhbCA9ICQoZWwpLmZpbmQoc2VsZWN0b3IpLmxlbmd0aDtcbiAgY29uc3QgcGFzcyA9IGFjdHVhbCA+IDA7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBjb250YWluIGNoaWxkICcke3NlbGVjdG9yfSdgO1xuXG4gIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbn0pO1xuXG4vKipcbiAqXG4gKiBleHBlY3QoJ2RpdicpLnRvSGF2ZURlc2NlbmRhbnRXaXRoVGV4dCh7c2VsZWN0b3I6ICcuY2hpbGQnLCB0ZXh0OiAndGV4dCd9KVxuICovXG5leHBvcnQgY29uc3QgdG9IYXZlRGVzY2VuZGFudFdpdGhUZXh0ID0gY29tcGFyYXRvcigoZWwsIHsgc2VsZWN0b3IsIHRleHQgfSkgPT4ge1xuICBjb25zdCBhY3R1YWwgPSAkLnRyaW0oJChlbCkuZmluZChzZWxlY3RvcikudGV4dCgpKTtcbiAgaWYgKHRleHQgJiYgJC5pc0Z1bmN0aW9uKHRleHQudGVzdCkpIHtcbiAgICBjb25zdCBwYXNzID0gdGV4dC50ZXN0KGFjdHVhbCk7XG4gICAgY29uc3QgbWVzc2FnZSA9ICgpID0+XG4gICAgICBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIGRlc2NlbmRhbnQgJyR7c2VsZWN0b3J9JyB3aXRoIHRleHQgbWF0Y2hpbmcgJyR7dGV4dH0nLGAgKyBgIGJ1dCBoYWQgJyR7YWN0dWFsfSdgO1xuXG4gICAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xuICB9XG4gIGNvbnN0IHBhc3MgPSBhY3R1YWwuaW5kZXhPZih0ZXh0KSAhPT0gLTE7XG4gIGNvbnN0IG1lc3NhZ2UgPSAoKSA9PiBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIGRlc2NlbmRhbnQgJyR7c2VsZWN0b3J9JyB3aXRoIHRleHQgJyR7dGV4dH0nLCBidXQgaGFkICcke2FjdHVhbH0nYDtcblxuICByZXR1cm4geyBwYXNzLCBtZXNzYWdlIH07XG59KTtcblxuZXhwb3J0IGNvbnN0IHRvSGF2ZVNlbGVjdGVkT3B0aW9ucyA9IGNvbXBhcmF0b3IoKGVsLCBleHBlY3RlZCkgPT4ge1xuICBpZiAoZXhwZWN0ZWQgaW5zdGFuY2VvZiBIVE1MT3B0aW9uRWxlbWVudCkge1xuICAgIGNvbnN0IGFjdHVhbCA9ICQoZWwpLmZpbmQoJzpzZWxlY3RlZCcpO1xuXG4gICAgY29uc3QgcGFzcyA9IGFjdHVhbC5pcygkKGV4cGVjdGVkKSk7XG5cbiAgICBjb25zdCBtZXNzYWdlID0gKCkgPT5cbiAgICAgIGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgb3B0aW9ucyAnWyR7ZXhwZWN0ZWQub3V0ZXJIVE1MfV0nIGJ1dCBoYWQgJ1ske2FjdHVhbFswXS5vdXRlckhUTUx9XSdgO1xuXG4gICAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xuICB9XG5cbiAgaWYgKGlzSFRNTE9wdGlvbkVsZW1lbnRBcnJheShleHBlY3RlZCkpIHtcbiAgICBjb25zdCBhY3R1YWwgPSAkKGVsKS5maW5kKCc6c2VsZWN0ZWQnKTtcblxuICAgIGNvbnN0IHBhc3MgPSBhY3R1YWwubGVuZ3RoID09PSBleHBlY3RlZC5sZW5ndGggJiYgYWN0dWFsLnRvQXJyYXkoKS5ldmVyeSgoXywgaW5kZXgpID0+ICQoYWN0dWFsW2luZGV4XSkuaXMoZXhwZWN0ZWRbaW5kZXhdKSk7XG5cbiAgICBjb25zdCBleHBlY3RlZE9wdGlvbnNTdHJpbmcgPSAkKGV4cGVjdGVkKVxuICAgICAgLmdldCgpXG4gICAgICAubWFwKChvcHRpb24pID0+IG9wdGlvbi5vdXRlckhUTUwpXG4gICAgICAuam9pbignLCcpO1xuXG4gICAgY29uc3QgYWN0dWFsT3B0aW9uc1N0cmluZyA9IGFjdHVhbFxuICAgICAgLmdldCgpXG4gICAgICAubWFwKChvcHRpb24pID0+IG9wdGlvbi5vdXRlckhUTUwpXG4gICAgICAuam9pbignLCcpO1xuXG4gICAgY29uc3QgbWVzc2FnZSA9ICgpID0+XG4gICAgICBgRXhwZWN0ZWQgZWxlbWVudCR7cGFzcyA/ICcgbm90JyA6ICcnfSB0byBoYXZlIG9wdGlvbnMgJ1ske2V4cGVjdGVkT3B0aW9uc1N0cmluZ31dJyBidXQgaGFkICdbJHthY3R1YWxPcHRpb25zU3RyaW5nfV0nYDtcblxuICAgIHJldHVybiB7IHBhc3MsIG1lc3NhZ2UgfTtcbiAgfVxuXG4gIGNvbnN0IGFjdHVhbDogc3RyaW5nW10gPSAkKGVsKS52YWwoKTtcblxuICBjb25zdCBwYXNzID0gY29lcmNlQXJyYXkoZXhwZWN0ZWQpPy5ldmVyeSgodikgPT4gYWN0dWFsLmluY2x1ZGVzKHYpKTtcblxuICBjb25zdCBleHBlY3RlZE9wdGlvbnNTdHJpbmcgPSBBcnJheS5pc0FycmF5KGV4cGVjdGVkKVxuICAgID8gZXhwZWN0ZWQucmVkdWNlKChhY2M6IHN0cmluZywgdmFsOiBzdHJpbmcsIGkpID0+IGFjYyArIGAke2kgPT09IGV4cGVjdGVkLmxlbmd0aCA/ICcnIDogJywnfSR7dmFsfWApXG4gICAgOiBleHBlY3RlZDtcbiAgY29uc3QgbWVzc2FnZSA9ICgpID0+IGBFeHBlY3RlZCBlbGVtZW50JHtwYXNzID8gJyBub3QnIDogJyd9IHRvIGhhdmUgb3B0aW9ucyAnWyR7ZXhwZWN0ZWRPcHRpb25zU3RyaW5nfV0nIGJ1dCBoYWQgJ1ske2FjdHVhbH1dJ2A7XG5cbiAgcmV0dXJuIHsgcGFzcywgbWVzc2FnZSB9O1xufSk7XG4iXX0=